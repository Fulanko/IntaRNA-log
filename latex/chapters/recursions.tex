\section{Recursions}

\subsection{Definitions}

$S^1, S^2$ target and query sequences\\
$i_1, j_1, i_2, j_2$ interaction boundaries\\
$si_1, sj_1, si_2, sj_2$ seed boundaries\\
$N$ the maximum interaction length $(\sim 150)$\\
$M$ the enclosed unpaired positions in one loop $(\sim 15)$

General energy computation:

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.45]{seedenergy_general.png}
\end{figure}

\begin{equation*}
E(\substack{i_1,j_1\\i_2,j_2}) = E_{h}(\substack{i_1,j_1\\i_2,j_2}) + ED_{1}(\substack{i_1\\j_1}) + ED_{2}(\substack{i_2\\j_2})
\end{equation*}

Optimization task: [TODO]

\subsection{Initialization}

\begin{equation*}
\underset{{\substack{si_1 <= i_{1} <= j_{1} <= sj_{1}\\si_2 <= i_{2} <= j_{2} <= sj_{2}}}}{\forall} E_h(\substack{i_1,j_1\\i_2,j_2}) = \infty
\end{equation*}

\begin{equation*}
E_h(\substack{si_1,sj_1\\si_2,sj_2}) = E_{seed}
\end{equation*}

\clearpage

\subsection{Recursion 1 ($O(N^{4})$ space + time)}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.65]{seedenergy.png}
\end{figure}

\begin{equation*}
\substack{
  \underset{\substack{si_{1}-N <= i_{1} <= si_{1}\\si_{2}-N <= i_{2} <= si_{2}}}{\forall}\\
  \underset{\substack{sj_{1} <= j_{1} <= sj_{1}+N\\sj_{2} <= j_{2} <= sj_{2}+N}}{\forall}
}
E_h(\substack{i_1,j_1\\i_2,j_2}) = \begin{cases}
  \infty\\
  \quad\text{: if } \text{ no matching base pair }\\
  \infty\\
  \quad\text{: if } j_{1} - i_{1} > N \text{ oder } j_{2} - i_{2} > N\\
  \min\limits_{\substack{i_{1} < l_{1} <= r_{1} < j_{1}\\i_{2} < l_{2} <= r_{2} < j_{2}\\l_{1} - i_{1} - 1 <= M\\j_{1}-r_{1}-1 <= M\\l_{2} - i_{2} - 1 <= M\\j_{2}-r_{2}-1 <= M}}
  \begin{pmatrix}
	E_{loop}(\substack{i_1,l_1\\i_2,l_2}) + E_h(\substack{l_1,r_1\\l_2,r_2}) + E_{loop}(\substack{r_1,j_1\\r_2,j_2})
  \end{pmatrix}\\
  \quad\text{: otherwise.}\\
  
\end{cases}
\end{equation*}

\clearpage

\subsection{Recursion 2 ($O(N^{2})$ space + $O(N^{4})$ time)}

\begin{figure}[H]
	\centering
	\includegraphics[scale=0.65]{seedenergy2.png}
\end{figure}

\begin{equation*}
E_h(\substack{i_1,j_1\\i_2,j_2}) = \begin{cases}
\infty\\
\quad\text{: if } j_{1} - i_{1} > N \text{ oder } j_{2} - i_{2} > N\\
\begin{pmatrix}
E_{L}(\substack{i_1\\i_2}) + E_{seed} + E_{R}(\substack{j_1\\j_2})
\end{pmatrix}\\
\quad\text{: otherwise.}\\
\end{cases}
\end{equation*}

\begin{equation*}
\underset{\substack{si_{1}-N <= i_{1} <= si_{1}\\si_{2}-N <= i_{2} <= si_{2}}}{\forall}\\
E_L(\substack{i_1\\i_2}) = \begin{cases}
\infty\\
\quad\text{: if } \text{ no matching base pair }\\
\min\limits_{\substack{l_{1} - i_{1} - 1 <= M\\l_{2} - i_{2} - 1 <= M}}
\begin{pmatrix}
E_L(\substack{l_1\\l_2}) + E_{loop}(\substack{i_1,l_1\\i_2,l_2})
\end{pmatrix}\\
\quad\text{: otherwise.}\\

\end{cases}
\end{equation*}

\begin{equation*}
\underset{\substack{sj_{1} <= j_{1} <= sj_{1}+N\\sj_{2} <= j_{2} <= sj_{2}+N}}{\forall}
E_R(\substack{j_1\\j_2}) = \begin{cases}
\infty\\
\quad\text{: if } \text{ no matching base pair }\\
\min\limits_{\substack{j_{1}-r_{1}-1 <= M\\j_{2}-r_{2}-1 <= M}}
\begin{pmatrix}
E_{loop}(\substack{r_1,j_1\\r_2,j_2}) + E_R(\substack{r_1\\r_2})
\end{pmatrix}\\
\quad\text{: otherwise.}\\

\end{cases}
\end{equation*}

